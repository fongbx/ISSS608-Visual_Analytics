{
  "hash": "3e2f5b4ab0509fd023023d15a375fc24",
  "result": {
    "markdown": "---\ntitle: \"In-class Exercise 01\"\nauthor: \"Fong Bao Xian\"\n---\n\n\n# Getting Started\n\n## Install and Launch R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse)\n```\n:::\n\n\n## Import Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv('data/Exam_data.csv')\n```\n:::\n\n\nWe will now examine the data further.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(exam_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  ID         CLASS GENDER RACE    ENGLISH MATHS SCIENCE\n  <chr>      <chr> <chr>  <chr>     <dbl> <dbl>   <dbl>\n1 Student321 3I    Male   Malay        21     9      15\n2 Student305 3I    Female Malay        24    22      16\n3 Student289 3H    Male   Chinese      26    16      16\n4 Student227 3F    Male   Chinese      27    77      31\n5 Student318 3I    Male   Malay        27    11      25\n6 Student306 3I    Female Malay        31    16      16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(exam_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [322 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ ID     : chr [1:322] \"Student321\" \"Student305\" \"Student289\" \"Student227\" ...\n $ CLASS  : chr [1:322] \"3I\" \"3I\" \"3H\" \"3F\" ...\n $ GENDER : chr [1:322] \"Male\" \"Female\" \"Male\" \"Male\" ...\n $ RACE   : chr [1:322] \"Malay\" \"Malay\" \"Chinese\" \"Chinese\" ...\n $ ENGLISH: num [1:322] 21 24 26 27 27 31 31 31 33 34 ...\n $ MATHS  : num [1:322] 9 22 16 77 11 16 21 18 19 49 ...\n $ SCIENCE: num [1:322] 15 16 16 31 25 16 25 27 15 37 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   ID = col_character(),\n  ..   CLASS = col_character(),\n  ..   GENDER = col_character(),\n  ..   RACE = col_character(),\n  ..   ENGLISH = col_double(),\n  ..   MATHS = col_double(),\n  ..   SCIENCE = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n\nThe variables `CLASS`, `GENDER` and `RACE` are currently character data format. We will change them to factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data$CLASS <- as.factor(exam_data$CLASS)\nexam_data$GENDER <- as.factor(exam_data$GENDER)\nexam_data$RACE <- as.factor(exam_data$RACE)\n```\n:::\n\n\n# Plotting Exercises\n\n## Exercise 1\n\n::: panel-tabset\n## Original Design\n\nWe can beautify the chart by adjusting the theme.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Improved Design\n\nBelow is an example of how we can adjust the theme of the chart. Here, we will change the colours of plot panel background to light blue and the colour of grid lines to white.\n\nFor more information on adjusting the theme, refer [here](https://ggplot2-book.org/polishing.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar() +\n  coord_flip() +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill='lightblue', colour='lightblue',\n                                    size=0.5, linetype='solid'),\n    panel.grid.major = element_line(size=0.5, linetype='solid', colour='white'),\n    panel.grid.minor = element_line(size=0.5, linetype='solid', colour='white'))\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n:::\n\n## Exercise 2\n\n::: panel-tabset\n## Original Design\n\nIn the original chart, there are the following issues:\n\n-   y-axis label is not clear (i.e., count)\n-   To support effective comparison, the bars should be sorted by their respective frequency\n-   For static graph, frequency values should be added to provide additional information\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=RACE)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Improved Design\n\nBelow is the makeover of the chart. There are a few ways to plot the same chart.\n\n**Alternative 1 - Processing before plotting**\n\n-   We need to include `stat='identity'`, which is basically telling ggplot2 you will provide the y-values for the barplot, rather than counting the aggregate number of rows for each x value, which is the default `stat=count`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data %>%\n  group_by(RACE) %>% \n  summarise(count=n()) %>% \n  mutate(pct = round((count/sum(count))*100,1)) %>% # we can also use prop.table(count) to get pct\n  # if we do an arrange(desc(count)) before ggplot, there is no need for reorder below\n  ggplot(aes(x=reorder(RACE, desc(count)), y=count)) +\n    geom_bar(stat='identity') +\n    ylim(0,220) +\n    labs(x='Race', y='No. of\\nPupils') +\n    geom_text(aes(label=paste0(count, ', ', pct, '%'), vjust = -0.5)) +\n    theme(axis.title.y=element_text(angle=0))\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n**Alternative 2 - Processing during plotting**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=reorder(RACE,RACE, function(x) -length(x)))) + # if ascending order remove minus\n  geom_bar() +\n  ylim(0,220) +\n  labs(x='Race', y='No. of\\nPupils') +\n  geom_text(stat='count',\n            aes(label=paste0(after_stat(count), ', ',\n                             round(after_stat(count)/\n                                     sum(after_stat(count))*100, 1), '%')),\n            vjust=-0.5) +\n  theme(axis.title.y=element_text(angle=0))\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n**Alternative 3 - Using forcats package**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(forcats)\n\nggplot(data=exam_data,\n       # for ascending order use fct_rev(fct_infreq(RACE))\n       aes(x = fct_infreq(RACE))) + \n  geom_bar() +\n  ylim(0,220) +\n  labs(x='Race', y='No. of\\nPupils') +\n  geom_text(stat='count',\n            aes(label=paste0(after_stat(count), ', ',\n                             round(after_stat(count)/\n                                     sum(after_stat(count))*100, 1), '%')),\n            vjust=-0.5) +\n  theme(axis.title.y=element_text(angle=0))\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n:::\n\n## Exercise 3\n\n::: panel-tabset\n## Original Design\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS)) +\n  geom_histogram(bins=20)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Improved Design\n\nWe will improve the design with the following:\n\n-   Adding mean and median lines on the histogram plot\n-   Change fill colour and line colour\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS)) +\n  geom_histogram(bins=20, color='black', fill='lightblue') +\n  geom_vline(xintercept=mean(exam_data$MATHS, na.rm=T),\n             color='red', linetype='dashed', size=1) +\n  geom_vline(xintercept=median(exam_data$MATHS, na.rm=T),\n             color='blue', linetype='dashed', size=1)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n:::\n\n## Exercise 4\n\n::: panel-tabset\n## Original Design\n\nThe below histograms are not informative. This is because they only reveal the distribution of English scores by gender but without context such as all pupils.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=ENGLISH)) +\n  geom_histogram() +\n  facet_wrap(~ GENDER)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Improved Design\n\nWe will create a makeover as shown below. The background histograms show the distribution of English scores of all pupils.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data_wo_gender <- exam_data[,-3] # remove column 3\n\nggplot(data=exam_data,\n       aes(x=ENGLISH, fill=GENDER)) +\n  # first hist plots the background, second hist plots the foreground\n  geom_histogram(data=exam_data_wo_gender, fill='grey', alpha=0.5) +\n  geom_histogram(colour='black') +\n  facet_grid(~ GENDER) +\n  guides(fill=FALSE) + # removes the legend\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n:::\n\n## Exercise 5\n\n::: panel-tabset\n## Original Design\n\nThe original chart shows minimal information.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x=MATHS, y=ENGLISH)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Improved Design\n\nWe will improve the design with the following:\n\n-   Changing to equal axis\n-   Including guides to inform where the passing grades are\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS, y=ENGLISH)) +\n  geom_point() +\n  coord_cartesian(xlim=c(0,100), ylim=c(0,100)) +\n  geom_vline(xintercept=50, linetype='dashed', colour='grey60',\n             size=1.5, alpha=0.8) +\n  geom_hline(yintercept=50, linetype='dashed', colour='grey60',\n             size=1.5, alpha=0.8) +\n  theme(aspect.ratio=1) # enables plot to be square-shaped\n```\n\n::: {.cell-output-display}\n![](In-class_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n:::\n",
    "supporting": [
      "In-class_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}